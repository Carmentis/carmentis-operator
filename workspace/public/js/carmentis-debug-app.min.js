/**
  Licensed under the Apache License, Version 2.0
  (c)2022-2024 Carmentis SAS
  Built 2024-10-31T16:11:31.054Z
*/
var CarmentisApp=function(e){"use strict";const t=Carmentis.core.storage.fileSystem,a=Carmentis.core.util.textEncoder;let n,c,i=t.directory("WALLET");function r(e){c=e}async function s(e,t=!0){let n,c=await o(e,t);try{n=JSON.parse(a.decode(c))}catch(e){n=null}return n}async function o(e,t=!0){let a=await i.byUid(n,e).read();return console.log("read",n,e,a),t?await c.decrypt(a):a}async function p(e,t,n=!0){let c=a.encode(JSON.stringify(t));return await l(e,c,n)}async function l(e,t,a=!0){return a&&(t=await c.encrypt(t)),console.log("write",n,e,t),await i.byUid(n,e).write(t)}async function u(e){return await i.byUid(n,e).del()}const d=Carmentis.core.constants,m=Carmentis.web.dom,_=Carmentis.core.util.helpers,f="0.3",y=12,b="https://node.themis.carmentis.io",h="http://localhost:3002";let g,w,v,k;async function x(e){g=e,function(e){n="walletFile"+e}(e),await async function(){let e=await s("config",!1);return e||(e={nodeEndpoint:b,dataEndpoint:h}),w.config=e,Q(),e}()}async function C(e){w.seed=null,w.accounts=[],w.currentAccount=0,await x(e),m.get("#_app_user").find("span").text(" "+String.fromCharCode(65+e)),X(null,m.create("div","_app_splash").append(m.create("div").text("version "+f)));let t=await async function(){return await i.byUid(n,"seed").exists()}()?A:N;setTimeout(t,1500)}function A(){X(null,te("Enter your password"),m.create("p").className("_app_center").text("Please enter your password to unlock your wallet."),m.create("input","_app_pwd").setAttribute("type","password").event("input",(e=>m.get("#_app_error").style({visibility:"hidden"}))),m.create("p","_app_error").className("_app_center _app_error").text("invalid password").style({visibility:"hidden"}),m.create("button").text("Submit").click((async function(){let e=m.get("#_app_pwd").el.value;r(await Carmentis.deriveAesKeyFromPassword(e));let t=await o("seed");!1===t?m.get("#_app_error").style({visibility:"visible"}):(await async function(){w.accounts=await s("accounts")}(),w.seed=t,R())})))}function N(){function e(){let e=m.get("#_app_pwd1").el.value,t=m.get("#_app_pwd2").el.value,a=m.get("#_app_agree").el.checked;m.get("#_app_ok").disabled(""==e||t!=e||!a)}X(null,te("Choose a password"),m.create("p").className("_app_center").text("Choose a password to protect your wallet."),m.create("input","_app_pwd1").setAttribute("type","password").event("input",e),m.create("p").className("_app_center _app_mt16").text("Confirm your password."),m.create("input","_app_pwd2").setAttribute("type","password").event("input",e),H("_app_agree",'I understand that Carmentis cannot help me recover my password (<a href="#" id="_app_learn">learn more</a>).',e),m.create("button","_app_ok").text("Submit").click((async function(){let e=m.get("#_app_pwd1").el.value;r(await Carmentis.deriveAesKeyFromPassword(e)),X(null,te("Private key"),m.create("p").text("No private key is currently stored in your wallet."),m.create("p").text("You may either create a new key or import an existing one."),m.create("button").text("Create").click(D),m.create("button").text("Import").click(P))})).disabled(!0)),m.get("#_app_learn").click(V)}function D(){w.wordList=Carmentis.generateWordList(y),T(S,!1,!0)}function T(e,t,a){X(null,te("Your passphrase"),m.create("p").text("Store your passphrase securely in different locations. Never share it with anyone."),m.create("table").className("_app_passphrase_table").append(...[...Array(y/3).keys()].map((e=>m.create("tr").append(...[0,1,2].map((t=>m.create("td").text(w.wordList[3*e+t]))))))),m.create("p").className("_app_center _app_mt16").append(m.create("a").setAttribute("href","#").html('<i class="bi bi-copy"></i> Copy the passphrase').click((e=>{e.preventDefault(),navigator.clipboard.writeText(w.wordList.join(" "))}))),...a?[H(null,'I understand that Carmentis cannot help me recover my passphrase (<a href="#" id="_app_learn">learn more</a>).',(e=>m.get("#_app_ok").disabled(!e)),t)]:[m.create("p").html('Remainder: Carmentis cannot help you recover your passphrase (<a href="#" id="_app_learn">learn more</a>).')],m.create("button","_app_ok").text("OK").click(e).disabled(!t)),m.get("#_app_learn").click(V)}async function S(){let e=[...Array(y).keys()];for(let t=y;--t;){let a=Math.random()*(t+1)|0;[e[t],e[a]]=[e[a],e[t]]}function t(){m.get("#_app_ok").disabled(e.some((e=>m.get("#_app_w"+e).el.value.trim().toLowerCase()!=w.wordList[e])))}e=e.slice(0,3),X(null,te("Confirm your passphrase"),m.create("p").className("_app_center").text("Please fill in the missing words."),m.create("table").className("_app_passphrase_table").append(...[...Array(y/3).keys()].map((a=>m.create("tr").append(...[0,1,2].map((n=>{let c=m.create("td"),i=3*a+n;return e.includes(i)?c.append(m.create("input","_app_w"+i).className("_app_missing_word").setAttribute("maxlength",8).event("input",t)):c.text(w.wordList[i]),c})))))),m.create("button","_app_ok").text("OK").click((async function(){await E(w.wordList)&&R()})).disabled(!0),m.create("p").className("_app_center _app_mt16").append(m.create("a").setAttribute("href","#").html('<i class="bi bi-eye"></i> Show the passphrase again').click((e=>{e.preventDefault(),T(S,!0,!0)}))))}function P(){X(null,te("Your passphrase"),m.create("p").className("_app_center").text("Please enter your passphrase below."),m.create("textarea","_app_data").style({height:"110px"}),m.create("button").text("OK").click((async function(){let e=m.get("#_app_data").el.value.trim().split(/\s+/);await E(e)&&R()})))}async function E(e){try{let t=await Carmentis.getSeedFromWordList(e);return await l("seed",t),w.seed=t,!0}catch(e){return!1}}function R(){if(!w.accounts.length)return void U(0);const e=[["Scan","qr-code-scan",O],["Accounts","person",j],["Parameters","gear",W]];X(null,te("Welcome"),m.create("p").className("_app_center").text(`Account #${w.currentAccount+1} - ${w.accounts[w.currentAccount].name}`),m.create("div","_app_menu").append(...e.map((([e,t,a])=>m.create("div").className("_app_menu_item").append(m.create("div").append(ne(t)),m.create("div").text(e)).click(a)))))}async function L(e){let t=G(e),a=await re(e);X(j,te("Account #"+(e+1)),ae("Account name"),m.create("p").className("_app_m12").text(t.name),ae("Public account key"),se(a),oe(a),m.create("button").text("Modify the account name").click((t=>U(e,(t=>L(e))))),m.create("button").text("Your personal data").click((t=>K(e))),m.create("button").text("Show private keys").click((t=>async function(e){w.accounts[e];let t=await Carmentis.derivePepperFromSeed(w.seed,e+1),a=await Carmentis.deriveOrganizationPrivateKey(t),n=await Carmentis.deriveNodePrivateKey(t);X((t=>L(e)),te("Account #"+(e+1)),ae("Private organization key"),se(a),oe(a),ae("Private node key"),se(n),oe(n),m.create("button").text("Close").click((t=>L(e))))}(e))),m.create("button").text("Close").click(j))}function U(e,t){let a=G(e);X(t,te("Account #"+(e+1)),m.create("p").className("_app_center").text("Enter a name to identify your account."),m.create("input","_app_name").className("_app_center").value(a.name),m.create("button").text("Confirm").click((async function(){a.name=Z("name"),await ee(),(t||R)()})))}function K(e){let t=G(e),a=t.userData.email&&!t.userData.emailProof;if(X((t=>L(e)),te("Account #"+(e+1))),[["firstname","Firstname"],["lastname","Lastname"],["email","Email"]].forEach((([e,a])=>{J(ae(a),m.create("p").className("_app_m12").text(t.userData[e]||"(not specified)"))})),t.userData.emailProof){let e=new Date(1e3*t.userData.emailProof.ts),a=e.toLocaleDateString("en-US"),n=e.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"});J(m.create("p").className("_app_m12 _app_success").style({marginTop:"-10px"}).html(`<i class="bi bi-check-circle-fill"></i> <span style="font-weight:bold">verified</span> on ${a}, at ${n}`))}a&&J(m.create("button").className("_app_mt16").text("Verify your email").click((t=>I(e)))),J(m.create("button").className(a?"":"_app_mt16").text("Edit").click((t=>function(e){let t=G(e),a=t.userData.email;X((t=>K(e)),te("Account #"+(e+1)),m.create("label").text("Firstname"),m.create("input","_app_firstname").value(t.userData.firstname),m.create("label").text("Lastname"),m.create("input","_app_lastname").value(t.userData.lastname),m.create("label").text("Email"),m.create("input","_app_email").value(t.userData.email),m.create("button").className("_app_mt16").text("Confirm").click((async function(){t.userData.firstname=Z("firstname"),t.userData.lastname=Z("lastname"),t.userData.email=Z("email"),t.userData.email!=a&&delete t.userData.emailProof,await ee(),K(e)})))}(e))),m.create("button").text("Close").click((t=>L(e))))}async function I(e,t=!0){let a=G(e);if(t){de();let t=await re(e),n=await Carmentis.dataServerQuery("email-validator/initialize",{email:a.userData.email,publicKey:pe(t)});w.otpToken=n.data.token,await me()}X((t=>K(e)),te("Email verification"),m.create("p").text("A 6-digit verification code has been sent to your email address. Please enter this code below."),m.create("input","_app_otp").className("_app_otp").setAttribute("maxlength",6),m.create("button").className("_app_mt16").text("Confirm").click((async function(){let t=await Carmentis.dataServerQuery("email-validator/answer",{token:w.otpToken,value:Z("otp")});t.success?(a.userData.emailProof=t.data.proof,await ee(),function(e=R){X(null,m.create("div").className("_app_notif_icon _app_success_bg").append(ne("check-lg"))),setTimeout(e,1e3)}((t=>K(e)))):ue((t=>I(e,!1)))})))}function O(){X(R,te("Scan the QR code"),m.create("div").className("_app_scan").append(m.create("div").className("_app_scan_top_left"),m.create("div").className("_app_scan_top_right"),m.create("div").className("_app_scan_bottom_left"),m.create("div").className("_app_scan_bottom_right")),m.create("div").className("_app_qr")),setTimeout((e=>{let t=m.get("#qr"),a=t.find("img");m.get("._app_qr").append(m.create("img").setAttribute("src",a.getAttribute("src"))),setTimeout((async e=>{let a=t.getAttribute("data-code");await async function(){return new Promise((function(e,t){let a=new Audio("assets/debug-app/audio/success.ogg");a.addEventListener("ended",(t=>{e()})),a.play()}))}(),await async function(e){let t=await Carmentis.wallet.getRequestByQRCode(e);console.log("processQRCode",t),t?async function(e){console.log("confirmDevice",e);let t=await Carmentis.dataServerQuery("geolocation/query",{ip:e.ip});if(!t.success)return ue(),!1;let a=t.data.geo,n=[["Country",d.COUNTRY.country[a.countryCode]],["City",a.city],["ASN",a.org.match(/^\S+ (.*)/)[1]],["IP address",e.ip]];X(R,te("Warning"),m.create("p").text("The website and/or device showing this QR code is currently not linked to your wallet."),m.create("p").className("_app_mt16").text("1. Make sure that the page displaying this QR code is "),m.create("p").className("_app_info").text(e.expectedDomain),m.create("p").text("2. Review the connection information below:"),ce(n),H("agree","Everything looks OK.",(e=>m.get("#_app_ok").disabled(!e))),m.create("button","_app_ok").text("Confirm").click((async function(){await e.accept()})).disabled(!0),m.create("button").text("Cancel").click((async function(){await e.reject(),R()})))}(t):ue()}(a)}),250)}),500)}async function Y(e){switch(console.log("processClientRequest",e),await new Promise((function(e,t){!function t(){w&&w.seed?e():(console.log("wallet locked"),setTimeout(t,100))}()})),console.log("wallet unlocked"),e.type){case"signIn":!async function(e){let t=await re(w.currentAccount),a=await ie(w.currentAccount);console.log("requestSignIn pubKey/privKey/sessionPubKey",t,a,e.data.sessionPublicKey);let n=await Carmentis.sign(a,le(e.data.sessionPublicKey));console.log("signature",n),X(null,te("Sign In Request"),m.create("p").text("Would you like to sign in to the Carmentis workspace?"),m.create("button").text("Confirm").click((function(){e.answer({success:!0,data:{pubKey:pe(t),sessionPubKeySignature:pe(n)}}),R()})),m.create("button").text("Cancel").click((function(){e.answer({success:!1}),R()})))}(e);break;case"authentication":!async function(e){let t=w.accounts[w.currentAccount].userData.emailProof;X(null,te("Authentication Request"),m.create("p").html(`Do you confirm your authentication as <b>${t.email}</b>?`),m.create("button").text("Confirm").click((function(){e.answer({success:!0,proof:t}),R()})),m.create("button").text("Cancel").click((function(){e.answer({success:!1}),R()})))}(e);break;case"eventApproval":!async function(e){let t=e.data.id;if(console.log("requestEventApproval",t),!/^[\da-f]{64}-[\da-f]{64}$/i.test(t))throw`invalid format for ID '${t}'`;let[a,n]=e.data.id.split("-"),c=await Carmentis.derivePepperFromSeed(w.seed,w.currentAccount+1),i=await Carmentis.deriveUserPrivateKey(c,le(a)),r=await Carmentis.getPublicKey(i);await e.answer({message:"walletHandshake",recordId:n,publicKey:pe(r)})}(e)}}async function F(e){"blockData"===e.type&&async function(e){v=await Carmentis.prepareApproval(e.data.applicationId,e.data.flowId,new Uint8Array(e.data.blockData)),$(e)}(e)}async function $(e){X(null,te("Approval"),m.create("div","_app_event_status"),m.create("hr"),m.create("p","_app_event_summary"),m.create("button").className("_app_button").html('<i class="bi bi-search"></i> See details').click((function(){q(e,k.record,k.appDef.field)})),H("_app_agree","I agree.",(e=>m.get("#_app_confirm").disabled(!e))),m.create("button","_app_confirm").className("_app_button_small").text("Confirm").click((async function(){de(),console.log("confirm",e),await e.answer({message:"confirmRecord",recordId:e.data.recordId}),await me(),e.clientAnswer({success:!0,recordId:e.data.recordId}),R()})).disabled(!0),m.create("button").className("_app_button_small").text("Cancel").click((function(){e.clientAnswer({success:!1}),R()})),m.create("div").style({position:"absolute",bottom:"10px"}).append(m.create("hr"),m.create("button").className("_app_button").html('<i class="bi bi-clock-history"></i> See history').click((t=>M(e))))),await _e(v.flowObject.chain.microBlock.length)}async function q(e,t,a,n=["root"],c=[]){let i=[];Object.keys(t).forEach((r=>{let s=t[r],o=a.find((e=>e.name==r));if(o.flag&d.DATA.ARRAY)i.push({name:r,def:o,value:s,bg:"primary",label:"open",click:e=>e});else if(o.flag&d.DATA.STRUCT)i.push({name:r,def:o,bg:"primary",label:"open",click:i=>q(e,s,k.appDef.structure[o.id].property,[...n,r],[...c,{node:t,fieldDef:a}])});else{let e,t;o.flag&d.DATA.PUBLIC?(e="success",t="public"):null===s?(e="danger",t="encrypted"):(e="success",t="decrypted"),i.push({name:r,def:o,value:s,bg:e,label:t,click:e=>e})}})),X(null,te("Event details"),m.create("p").className("_app_center").text(n.join(".")),...i.map((e=>m.create("p").append(m.create("b").text(e.name),m.create("span").style({float:"right",width:"80px",height:"19px",marginTop:"2px"}).className(`badge availability-badge rounded-pill bg-${e.bg}`).text(e.label).click(e.click),m.create("br"),...function(e){if(null===e.value)return["undisclosed"];if(e.def.flag&d.DATA.ARRAY)return[`array of ${e.value.length} entries`];if(e.def.flag&d.DATA.STRUCT)return["structure"];switch(e.def.id){case d.DATA.T_AMOUNT:return[e.value.amount+" "+e.value.currency];case d.DATA.T_FILE:return['"'+e.value.name+'"',"Size: "+_.formatNumber(e.value.size,{sep:","})+" bytes","CRCR32: "+e.value.crc32,"SHA256: "+e.value.sha256.slice(0,16)+"â‹¯"+e.value.sha256.slice(-4)];default:return['"'+e.value+'"']}}(e).map((e=>m.create("div").style({fontFamily:"monospace"}).text(e)))))),...c.length?[m.create("button").className("_app_button").text("Up").click((function(){let t=c.pop();q(e,t.node,t.fieldDef,n.slice(0,-1),c)}))]:[],m.create("button").className("_app_button").text("Back to event summary").click((t=>$(e))))}async function M(e){let t=v.flowObject.chain.microBlock.length;function a(){q(e,k.record,k.appDef.field)}X(null,te("Flow history"),...t>1?[...Array(t-1)].map(((t,n)=>m.create("button").className("_app_item_btn").text("Event "+(n+1)).click((t=>async function(t){X(null,te("Event "+t),m.create("div","_app_event_status"),m.create("hr"),m.create("p","_app_event_summary"),m.create("button").className("_app_button").html('<i class="bi bi-search"></i> See details').click(a),m.create("div").style({position:"absolute",bottom:"10px"}).append(m.create("hr"),m.create("button").className("_app_button").html("Close").click((t=>M(e))))),await _e(t)}(n+1))))):[m.create("p").text("This is the first event in this flow.")],m.create("button").className("_app_button").text("Back to approval").click((t=>$(e))))}function j(){X(R,te("Your accounts"),...w.accounts.map(((e,t)=>m.create("div").append(m.create("button").className("_app_item_btn").append(...t==w.currentAccount?[m.create("span").className("_app_btn_check").append(ne("check-circle-fill"))]:[],m.create("span").text(`#${t+1} - ${e.name}`)).click((e=>L(t)))))),m.create("hr"),m.create("button").html('<i class="bi bi-check2-circle"></i> Change active account').click(z),m.create("button").html('<i class="bi bi-plus-circle"></i> Create a new account').click((e=>U(w.accounts.length,j))),m.create("button").text("Close").click(R))}function z(){let e=w.currentAccount;X(j,te("Select active account"),...w.accounts.map(((t,a)=>m.create("div").append(m.create("input","_app_acct"+a).setAttribute("type","radio").setAttribute("name","accounts").checked(a==e).click((t=>e=a)),m.create("label").setAttribute("for","_app_acct"+a).text(`#${a+1} - ${t.name}`)))),m.create("button").className("_app_mt16").text("Confirm").click((function(){w.currentAccount=e,j()})))}function W(){X(R,te("Parameters"),m.create("button").text("Show the passphrase").click((async function(){w.wordList=Carmentis.getWordListFromSeed(w.seed),T(W,!0,!1)})),m.create("button").text("Set endpoints").click(B),m.create("button").className("_app_bg_red").text("Reset your wallet").click((async function(){await u("accounts"),await u("seed"),C()})))}function B(){X(W,te("Endpoints"),m.create("label").text("Node endpoint"),m.create("input","_app_node_endpoint").value(w.config.nodeEndpoint),m.create("label").text("Data endpoint"),m.create("input","_app_data_endpoint").value(w.config.dataEndpoint),m.create("button").className("_app_mt16").text("Confirm").click((async function(){w.config.nodeEndpoint=Z("node_endpoint"),w.config.dataEndpoint=Z("data_endpoint"),await async function(){try{return await p("config",w.config,!1),!0}catch(e){return!1}}(),Q(),W()})))}function Q(){console.log("applyConfig",w.config),Carmentis.registerNodeEndpoint(w.config.nodeEndpoint),Carmentis.registerDataEndpoint(w.config.dataEndpoint)}function H(e,t,a,n){let c=m.create("div").className("_app_checkbox").append(m.create("label").append(m.create("input",e).setAttribute("type","checkbox").checked(n),m.create("span").html(t)));return a&&c.event("change",(e=>a(e.target.checked))),c}function X(e,...t){w.backCallback=e,e&&t.push(m.create("div").className("_app_back").append(ne("arrow-left-short").click(e))),m.get("#_app_content").setContent(...t)}function J(...e){m.get("#_app_content").append(...e)}function V(e){e.preventDefault(),e.stopPropagation(),m.get("#_app_over").setContent(te("Security"),ae("Your data"),m.create("p").text("With Carmentis, and unlike what happens in a classic centralized system, your data is stored in an encrypted blockchain. You, and only you, have the ability to access your data using your private key."),ae("Your passphrase"),m.create("p").text("Your private key is derived from a passphrase. At no time does Carmentis have access to your passphrase. It is your responsibility to store it securely."),ae("Your password"),m.create("p").text("On a given device, your key is itself encrypted using a password for easier and faster access. At no time does Carmentis have access to your password. To renew it, you must provide either the previous password (on a specific device) or the original passphrase (on any device)."),m.create("button").text("OK").click((e=>m.get("#_app_over").hide()))).show()}function Z(e){return m.get("#_app_"+e).el.value.trim()}function G(e){let t=w.accounts[e]=w.accounts[e]||{name:""};return t.userData=t.userData||{},t.userData.firstname=t.userData.firstname||"",t.userData.lastname=t.userData.lastname||"",t.userData.email=t.userData.email||"",w.accounts[e]}async function ee(){await p("accounts",w.accounts)}function te(e){return m.create("div").className("_app_title").text(e)}function ae(e){return m.create("div").className("_app_section").html(e)}function ne(e){return m.create("i").className("bi bi-"+e)}function ce(e){return m.create("table").className("_app_info_table").append(...e.map((([e,t])=>m.create("tr").append(m.create("td").text(e),m.create("th").text(t)))))}async function ie(e){let t=await Carmentis.derivePepperFromSeed(w.seed,e+1);return await Carmentis.deriveAuthenticationPrivateKey(t)}async function re(e){let t=await ie(e);return await Carmentis.getPublicKey(t)}function se(e){let t=pe(e);return m.create("p").className("_app_key").html(t.slice(0,t.length/2)+"<br>"+t.slice(t.length/2))}function oe(e){return m.create("p").className("_app_center _app_mt16").append(m.create("a").setAttribute("href","#").html('<i class="bi bi-copy"></i> Copy this key').click((t=>{t.preventDefault(),navigator.clipboard.writeText(pe(e))})))}function pe(e){return[...e].map((e=>e.toString(16).toUpperCase().padStart(2,"0"))).join("")}function le(e){return new Uint8Array("string"==typeof e&&e.match(/^([\da-f]{2})*$/gi)?e.match(/../g).map((e=>parseInt(e,16))):[])}function ue(e=R){X(null,m.create("div").className("_app_notif_icon _app_error_bg").append(ne("x"))),setTimeout(e,1e3)}function de(){w.spinnerTs=+new Date,X(null,m.create("div").className("spinner-border text-primary _app_spinner"))}async function me(){let e=Math.max(0,w.spinnerTs+500-new Date);return await new Promise((function(t){setTimeout(t,e)}))}async function _e(e){k=await Carmentis.processRecord(v,e),console.log("processedRecord",k);let t=k.msgParts.map((e=>e.isField?m.create("span").className("_app_msg_field"+(null===e.value?" undisclosed":"")).setAttribute("data-bs-toggle","tooltip").setAttribute("title",e.field).text(function(e,t){if(null===t)return"undisclosed";if(e.flag&d.DATA.ARRAY)return`array of ${t.length} entries`;if(e.flag&d.DATA.STRUCT)return"structure";switch(e.id){case d.DATA.T_AMOUNT:return t.amount+" "+t.currency;case d.DATA.T_FILE:return t.name;default:return t}}(e.def,e.value)):m.textNode(e.value)));!function(e){v.flowObject.chain;let t=e.microBlock,a=new Date(1e3*t.ts),n=a.getUTCDate(),c=a.toLocaleString("en-US",{month:"long",timeZone:"UTC"})+" "+n+(["","st","nd","rd"][n%10]||"th")+", "+a.getUTCFullYear(),i=a.getUTCHours().toString().padStart(2,"0")+":"+a.getUTCMinutes().toString().padStart(2,"0")+":"+a.getUTCSeconds().toString().padStart(2,"0")+" (UTC)",r=[["Application",v.appDescription.name+" | version "+v.flowObject.appVersion(t.nonce)],["Date",c],["Time",i],["Status",t.pending?"Awaiting user approval":"Anchored"]];m.get("#_app_event_status").setContent(ce(r))}(k.data),m.get("#_app_event_summary").setContent(...t),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach((e=>new bootstrap.Tooltip(e)))}return e.initialize=async function(e={}){w={},console.log("*** app.initialize set listener DOMContentLoaded ***"),window.addEventListener("DOMContentLoaded",(t=>function(e){console.log("*** initializeUi ***");let t=m.elementToObject(document.body),a="bottomLeft"==e.position?"bottom_left":"bottom_right",n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href="assets/debug-app/css/style.css",document.getElementsByTagName("head")[0].appendChild(n),t.append(m.create("div","_app_icon").className("_app_icon_"+a).append(m.create("div","_app_open").append(ne("phone"))).click((function(){c^=1,m.get("#_app_wrapper").show(c),c&&!i&&(i=!0,C(0))}))),t.append(m.create("div","_app_wrapper").append(m.create("div","_app_header").append(m.create("div","_app_user").append(ne("person-circle"),m.create("span")).click((function(){C(g^=1)})),m.create("div","_app_restart").append(ne("arrow-clockwise")).click(C),m.create("div","_app_close").append(ne("x-circle")).click((function(){c=0,m.get("#_app_wrapper").hide()}))),m.create("div","_app_screen").append(m.create("div","_app_over"),m.create("div","_app_content")),m.create("div","_app_footer").append(m.create("div","_app_back").append(ne("chevron-left")).click((e=>w.backCallback&&w.backCallback())))));let c=0,i=!1,r=m.get("#_app_wrapper"),s={move:!1};m.get("#_app_header").event("mousedown",(function(e){"_app_header"==e.target.id&&(s.move=!0,document.body.classList.add("no-select"),s.initX=e.offsetX,s.initY=e.offsetY)})),m.elementToObject(document).event("mousemove",(function(e){s.move&&r.style({left:Math.min(Math.max(0,e.clientX-s.initX),window.innerWidth-355)+"px",top:Math.min(Math.max(0,e.clientY-s.initY),window.innerHeight-711)+"px"})})),r.event("mouseup",(function(){s.move=!1,document.body.classList.remove("no-select")}))}(e))),await x(0),Carmentis.wallet.setRequestCallback(Y,F),Carmentis.wallet.attemptToReconnect()},e}({});